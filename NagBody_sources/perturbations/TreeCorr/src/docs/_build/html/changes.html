<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Changes from version 4.1 to 4.2 &mdash; TreeCorr 4.2.8 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Previous History" href="history.html" />
    <link rel="prev" title="Getting Started Guide" href="guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TreeCorr
          </a>
              <div class="version">
                4.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="catalog.html">Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation2.html">Two-point Correlation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation3.html">Three-point Correlation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="binning.html">Binning</a></li>
<li class="toctree-l1"><a class="reference internal" href="patches.html">Patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="cov.html">Covariance Estimates</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Using configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Getting Started Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Changes from version 4.1 to 4.2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#api-changes">API Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performance-improvements">Performance improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#new-features">New features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-0-to-4-2-1">Changes from version 4.2.0 to 4.2.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-1-to-4-2-2">Changes from version 4.2.1 to 4.2.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-2-to-4-2-3">Changes from version 4.2.2 to 4.2.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-3-to-4-2-4">Changes from version 4.2.3 to 4.2.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-4-to-4-2-5">Changes from version 4.2.4 to 4.2.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-5-to-4-2-6">Changes from version 4.2.5 to 4.2.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-6-to-4-2-7">Changes from version 4.2.6 to 4.2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="#changes-from-version-4-2-7-to-4-2-8">Changes from version 4.2.7 to 4.2.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Previous History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TreeCorr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Changes from version 4.1 to 4.2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/changes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="changes-from-version-4-1-to-4-2">
<h1>Changes from version 4.1 to 4.2<a class="headerlink" href="#changes-from-version-4-1-to-4-2" title="Permalink to this headline">¶</a></h1>
<p>This update mostly involves some improvements to the new patch-based
computations, in response to feedback from users, who have been trying it out
in a variety of use cases.  Especially note the new optional <code class="docutils literal notranslate"><span class="pre">func</span></code> argument
to <a class="reference internal" href="correlation2.html#treecorr.BinnedCorr2.estimate_cov" title="treecorr.BinnedCorr2.estimate_cov"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">BinnedCorr2.estimate_cov</span></code></a> and <a class="reference internal" href="correlation2.html#treecorr.estimate_multi_cov" title="treecorr.estimate_multi_cov"><code class="xref any py py-func docutils literal notranslate"><span class="pre">estimate_multi_cov</span></code></a>, which lets you
calculate covariances of arbitrary functions of a correlation object or list
of correlation objects.  See <a class="reference internal" href="cov.html#covariance-of-derived-quantities"><span class="std std-ref">Covariance of Derived Quantities</span></a> for details.</p>
<p>Another big improvement is the ability to correctly perform three-point
cross-correlations. I still don’t have heterogeneous cross correlations like
NGG or NNG, but now NNN, GGG, and KKK can be done correctly for 2 or 3
different catalogs.  This update does technically involve an API change,
since the old code tried to do something when given 3 catalogs, but it
wasn’t really correct, and (consequently) I don’t think anyone was actually
trying to use that feature.</p>
<p>See the listing below for the complete list of new features and changes.
<a class="reference external" href="https://github.com/rmjarvis/TreeCorr/milestone/7?closed=1">Relevant PRs and Issues,</a>
whose issue numbers are listed below for the relevant items.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will be the last (non-bug-fix) TreeCorr release to support Python 2.7.
It is becoming harder to continue to support this platform now that it is
officially sunsetted, so we encourage all users to switch their code to
Python 3.x ASAP.  TreeCorr is currently compatible with Python versions
2.7, 3.5, 3.6, 3.7, 3.8, 3.9.  We will probably also drop 3.5 in the next
release as well, since that is also retired at this point.</p>
</div>
<div class="section" id="api-changes">
<h2>API Changes<a class="headerlink" href="#api-changes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Changed the 3pt process function, when given 3 arguments, to accumulate all
triangles where points from the three input catalogs can fall into any
of the three triangle corners.  If you need the old behavior of keeping
track of which catalog goes into which triangle corner, the new
???CrossCorrelation classes do so both more efficiently and more
accurately than the previous code. (#115)</p></li>
<li><p>Changed the <a class="reference internal" href="nnn.html#treecorr.NNNCorrelation.calculateZeta" title="treecorr.NNNCorrelation.calculateZeta"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">NNNCorrelation.calculateZeta</span></code></a> function to only take
RDD and DRR parameters for the cross terms (if desired) rather than all
six (DDR, DRD, RDD, DRR, RDR, RRD).  The new cross-correlation behavior of
the <a class="reference internal" href="nnn.html#treecorr.NNNCorrelation.process" title="treecorr.NNNCorrelation.process"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">NNNCorrelation.process</span></code></a> function now efficiently calculates in RDD what
used to be calculated in three calls for DDR, DRD, and RDD.  Likewise the
new DRR calculates what used to require DRR, RDR, and RRD. (#122)</p></li>
</ul>
</div>
<div class="section" id="performance-improvements">
<h2>Performance improvements<a class="headerlink" href="#performance-improvements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Only show at most 10 rows with NaNs in cases where there are lots of such
rows. (#111)</p></li>
<li><p>No longer remakes patches and writes them to disk if they are already present
on disk.  If you want to force a rewrite for any reason, you can explicitly
call <a class="reference internal" href="catalog.html#treecorr.Catalog.write_patches" title="treecorr.Catalog.write_patches"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Catalog.write_patches</span></code></a>. (#116)</p></li>
<li><p>Computing the data/random cross correlations for 3pt are now much faster,
since you only need one call for RDD and one for DRR, not all the 6 different
permuations. (Specifically, DDR, DRD, RDR, RRD are no longer needed.) (#122)</p></li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Implement patch-based calculations for 3-point correlations.  This enables
things like jackknife correlations, low-memory calculations, and MPI execution
when doing NNN, KKK, or GGG correlations. (#97, #125)</p></li>
<li><p>Allow min_rpar and max_rpar for Euclidean metric.  Also Periodic, although
I don’t know if that’s useful. (#101)</p></li>
<li><p>Added ability to read from hdf5 catalogs.  (#106)</p></li>
<li><p>Added ability to use named columns in ASCII files if the file has column
names. (#108)</p></li>
<li><p>Added optional initialize=False and finalize=False options to process
functions. (#109)</p></li>
<li><p>Added ability to do 3 point cross-correlations properly, rather than the not
exactly correct version that had been implemented.  Not all combinations are
implemented.  So far just GGG, KKK, and NNN. (#115)</p></li>
<li><p>Added ability to read from parquet catalogs.  (#117)</p></li>
<li><p>Added optional func parameter to estimate_cov and estimate_multi_cov. (#118)</p></li>
<li><p>Added ability to write output files as hdf5.  (#122)</p></li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h2>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Fixed a couple problems that could arise in patch-based calculations when
one or more of the patches have no objects. (#123)</p></li>
</ul>
</div>
</div>
<div class="section" id="changes-from-version-4-2-0-to-4-2-1">
<h1>Changes from version 4.2.0 to 4.2.1<a class="headerlink" href="#changes-from-version-4-2-0-to-4-2-1" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a bug when running NN correlations with MPI.  Thanks to Joe Zuntz for
the bug report. (#127)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-1-to-4-2-2">
<h1>Changes from version 4.2.1 to 4.2.2<a class="headerlink" href="#changes-from-version-4-2-1-to-4-2-2" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a build problem with gcc versions 10 and 11.  Thanks to Johannes Lange
for reporting the problem.</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-2-to-4-2-3">
<h1>Changes from version 4.2.2 to 4.2.3<a class="headerlink" href="#changes-from-version-4-2-2-to-4-2-3" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a bug in the Map^3 calculation when the aperture radii are different.
Thanks to Laila Linke for both finding the problem and providing the fix. (#128)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-3-to-4-2-4">
<h1>Changes from version 4.2.3 to 4.2.4<a class="headerlink" href="#changes-from-version-4-2-3-to-4-2-4" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a bug when running the Rlens metric with patches. Thanks to Marina Ricci
for the bug report. (#131)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-4-to-4-2-5">
<h1>Changes from version 4.2.4 to 4.2.5<a class="headerlink" href="#changes-from-version-4-2-4-to-4-2-5" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed bugs in the shot noise variance estimate for GGG and the propagation of
the error to Map3.  Thanks to Lucas Secco for the bug report. (#133)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-5-to-4-2-6">
<h1>Changes from version 4.2.5 to 4.2.6<a class="headerlink" href="#changes-from-version-4-2-5-to-4-2-6" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a numerical bug that could suppress the signal in GG correlations in
spherical coordinates if there are multiple objects at the same position.
Thanks to Sandra Unruh for the bug report. (#134)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-6-to-4-2-7">
<h1>Changes from version 4.2.6 to 4.2.7<a class="headerlink" href="#changes-from-version-4-2-6-to-4-2-7" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a memory problem when computing patch-based covariance matrix when npatches
is moderately large (e.g. 500). Thanks to Joe Zuntz and Judit Prat for finding and
reporting the bug. (#137)</p></li>
</ul>
</div>
<div class="section" id="changes-from-version-4-2-7-to-4-2-8">
<h1>Changes from version 4.2.7 to 4.2.8<a class="headerlink" href="#changes-from-version-4-2-7-to-4-2-8" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Fixed a bug in the calculation of jackknife and sample variance when only the second
catalog in a cross-correlation uses patches.</p></li>
</ul>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="guide.html" class="btn btn-neutral float-left" title="Getting Started Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="history.html" class="btn btn-neutral float-right" title="Previous History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Mike Jarvis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>